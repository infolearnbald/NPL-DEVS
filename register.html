<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<title>Criar Conta - NPL DEVS</title>
<link rel="stylesheet" href="style.css">
</head>
<body class="bg">

<div class="card">
    <h1>Criar Conta</h1>

    <input type="text" id="username" placeholder="Username">
    <input type="email" id="email">
    <input type="password" id="password">

    <button id="registerBtn">Criar</button>

    <p id="errorMsg" class="error"></p>
</div>

<script type="module">
import { auth, db } from "./firebase.js";
import { createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-auth.js";
import { doc, setDoc } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-firestore.js";

const username = document.getElementById("username");
const email = document.getElementById("email");
const password = document.getElementById("password");
const registerBtn = document.getElementById("registerBtn");
const errorMsg = document.getElementById("errorMsg");

registerBtn.addEventListener("click", async () => {
    try {
        const cred = await createUserWithEmailAndPassword(auth, email.value, password.value);
        await setDoc(doc(db, "users", cred.user.uid), {
            username: username.value,
            email: email.value,
            createdAt: Date.now()
        });
        window.location.href = "chat.html";
    } catch (err) {
        errorMsg.innerText = "Erro: " + err.code;
    }
});
</script>

</body>
</html>
